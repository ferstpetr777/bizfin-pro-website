<?php
/**
 * ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° ÑÐ»Ð¾Ð² Ð² ÑÑ‚Ð°Ñ‚ÑŒÐµ Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¼ Ð¿Ð¾Ð´ÑÑ‡ÐµÑ‚Ð¾Ð¼
 */

// ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ WordPress
require_once('/var/www/bizfin_pro_r_usr/data/www/bizfin-pro.ru/wp-config.php');
require_once('/var/www/bizfin_pro_r_usr/data/www/bizfin-pro.ru/wp-load.php');

// ID ÑÑ‚Ð°Ñ‚ÑŒÐ¸
$post_id = 3027;

// ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð¿Ð¾ÑÑ‚
$post = get_post($post_id);

if (!$post) {
    die("Ð¡Ñ‚Ð°Ñ‚ÑŒÑ Ñ ID $post_id Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°\n");
}

echo "ðŸ“ ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° ÑÐ»Ð¾Ð² Ð² ÑÑ‚Ð°Ñ‚ÑŒÐµ: " . $post->post_title . "\n";

// Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ð´ÑÑ‡ÐµÑ‚Ð° ÑÐ»Ð¾Ð² Ð² Ñ€ÑƒÑÑÐºÐ¾Ð¼ Ñ‚ÐµÐºÑÑ‚Ðµ
function count_words_russian($text) {
    // Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ HTML Ñ‚ÐµÐ³Ð¸
    $text = strip_tags($text);
    
    // Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð»Ð¸ÑˆÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð±ÐµÐ»Ñ‹ Ð¸ Ð¿ÐµÑ€ÐµÐ½Ð¾ÑÑ‹ ÑÑ‚Ñ€Ð¾Ðº
    $text = preg_replace('/\s+/', ' ', $text);
    $text = trim($text);
    
    // Ð Ð°Ð·Ð±Ð¸Ð²Ð°ÐµÐ¼ Ð½Ð° ÑÐ»Ð¾Ð²Ð° Ð¿Ð¾ Ð¿Ñ€Ð¾Ð±ÐµÐ»Ð°Ð¼
    $words = explode(' ', $text);
    
    // Ð¤Ð¸Ð»ÑŒÑ‚Ñ€ÑƒÐµÐ¼ Ð¿ÑƒÑÑ‚Ñ‹Ðµ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹
    $words = array_filter($words, function($word) {
        return !empty(trim($word));
    });
    
    return count($words);
}

// ÐŸÐ¾Ð´ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ»Ð¾Ð²
$word_count = count_words_russian($post->post_content);

// ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð¼ÐµÑ‚Ð°-Ð´Ð°Ð½Ð½Ñ‹Ðµ
update_post_meta($post_id, '_bsag_word_count', $word_count);

echo "âœ… ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ»Ð¾Ð²: $word_count\n";

if ($word_count >= 2500) {
    echo "âœ… Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð¾ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð¼Ñƒ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ñƒ ÑÐ»Ð¾Ð² Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¾ (2500+)\n";
} else {
    echo "âš ï¸  ÐŸÑ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ðµ: ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ»Ð¾Ð² Ð¼ÐµÐ½ÑŒÑˆÐµ Ñ‚Ñ€ÐµÐ±ÑƒÐµÐ¼Ð¾Ð³Ð¾ Ð¼Ð¸Ð½Ð¸Ð¼ÑƒÐ¼Ð°\n";
    echo "ðŸ“ Ð¢ÐµÐºÑƒÑ‰ÐµÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ»Ð¾Ð²: $word_count Ð¸Ð· 2500 Ñ‚Ñ€ÐµÐ±ÑƒÐµÐ¼Ñ‹Ñ…\n";
}

// ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ URL ÑÑ‚Ð°Ñ‚ÑŒÐ¸
$article_url = get_permalink($post_id);
echo "âœ… Ð¡Ñ‚Ð°Ñ‚ÑŒÑ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð° Ð¿Ð¾ Ð°Ð´Ñ€ÐµÑÑƒ: $article_url\n";

echo "\nðŸŽ‰ ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾!\n";
?>

