<?php
// Запуск из корня WordPress-сайта: php fix-team-metadata.php
// Обновляет метаданные перепутанных вложений в медиатеке

require_once __DIR__ . '/wp-load.php';

function update_media_item(int $attachment_id, string $name, string $position, string $description): void {
    // Title + Content (description)
    wp_update_post([
        'ID'           => $attachment_id,
        'post_title'   => $name,
        'post_content' => $description,
    ]);

    // Alt
    update_post_meta($attachment_id, '_wp_attachment_image_alt', $name . ' — ' . $position);

    // Custom field (если ранее использовался)
    update_post_meta($attachment_id, 'position', $position);
}

echo "Правка метаданных команды...\n";

$fixes = [
    // ID 2255: сейчас подписан как «Мария Белоногова», фактически Александр Волоконцев
    2255 => [
        'name'        => 'Александр Волоконцев',
        'position'    => 'Финансовый консультант в области госзаказа, руководитель отдела по работе с корпоративными клиентами',
        'description' => 'Финансовый консультант в области госзаказа, руководитель отдела по работе с корпоративными клиентами. Обладает большим опытом в сфере госзакупок.'
    ],
    // ID 2256: сейчас «Евгения Носова», фактически Мария Белоногова
    2256 => [
        'name'        => 'Мария Белоногова',
        'position'    => 'Специалист отдела экспертизы и документарного сопровождения',
        'description' => 'Специалист отдела экспертизы и документарного сопровождения. Обеспечивает своевременную обработку документов и поддержку клиентов.'
    ],
    // ID 2257: сейчас «Александр Волоконцев», фактически Анастасия Лохова
    2257 => [
        'name'        => 'Анастасия Лохова',
        'position'    => 'Финансовый консультант в области госзаказа, специалист по работе с корпоративными клиентами',
        'description' => 'Финансовый консультант в области госзаказа. Эксперт по работе с корпоративными клиентами, оказывает поддержку на всех этапах сделки.'
    ],
    // ID 2253: сейчас «Анастасия Лохова», фактически Евгения Носова
    2253 => [
        'name'        => 'Евгения Носова',
        'position'    => 'Заместитель директора',
        'description' => 'Заместитель директора ООО Бизнес-Финанс. Отвечает за операционное управление и координацию работы отделов.'
    ],
];

foreach ($fixes as $id => $data) {
    update_media_item($id, $data['name'], $data['position'], $data['description']);
    echo "✓ Обновлено вложение ID {$id}: {$data['name']}\n";
}

echo "Готово.\n";

?>


